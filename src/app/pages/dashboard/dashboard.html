<div class="page">
    <div class="metrics">
        <app-metrics-card label="Total Issues" [value]="totals().total"></app-metrics-card>
        <app-metrics-card label="New" [value]="totals().new"></app-metrics-card>
        <app-metrics-card label="In Progress" [value]="totals().inProgress"></app-metrics-card>
        <app-metrics-card label="Resolved" [value]="totals().resolved"></app-metrics-card>
    </div>

    <nz-card class="board" style="border: 4px solid blue">
        <div class="board-title">Issues Dashboard</div>
        <div class="board-subtitle">View and manage reported issues</div>

        <div class="filters" style="border: 4px solid rgb(216, 98, 55)">
            <nz-select class="f" [(ngModel)]="teamFilter">
                <nz-option nzValue="" nzLabel="All Teams"></nz-option>
                <nz-option *ngFor="let t of teams" [nzValue]="t.id" [nzLabel]="t.name"></nz-option>
            </nz-select>

            <nz-select class="f" [(ngModel)]="statusFilter">
                <nz-option nzValue="" nzLabel="All Statuses"></nz-option>
                <nz-option *ngFor="let t of statusCategories" [nzValue]="t.id" [nzLabel]="t.label"></nz-option>
            </nz-select>

            <nz-select class="f" [(ngModel)]="categoryFilter">
                <nz-option nzValue="" nzLabel="All Categories"></nz-option>
                <nz-option *ngFor="let c of categories" [nzValue]="c.id" [nzLabel]="c.label"></nz-option>
            </nz-select>
        </div>

        <nz-tabset [(nzSelectedIndex)]="tabIndex">
            <nz-tab nzTitle="All Issues">
                <div class="list">
                    <app-issue-card *ngFor="let issue of filteredIssues()" [issue]="issue" [teams]="teams"
                        [categories]="categories" (statusChanged)="onStatusChange($event.issueId, $event.status)"
                        (teamChanged)="onTeamChange($event.issueId, $event.teamId)"
                        (sendToJira)="onSendToJira($event)" />
                </div>
            </nz-tab>

            <nz-tab nzTitle="By Team">
                <div class="list">
                    <div *ngFor="let group of groupedByTeam()">
                        <div class="group-title">{{ group.teamName }}</div>
                        <app-issue-card *ngFor="let issue of group.issues" [issue]="issue" [teams]="teams"
                            [categories]="categories" (statusChanged)="onStatusChange($event.issueId, $event.status)"
                            (teamChanged)="onTeamChange($event.issueId, $event.teamId)"
                            (sendToJira)="onSendToJira($event)" />
                    </div>
                </div>
            </nz-tab>
        </nz-tabset>
    </nz-card>
</div>